var mapboxsearchcore=(()=>{var N=Object.defineProperty,Ae=Object.defineProperties,we=Object.getOwnPropertyDescriptor,Oe=Object.getOwnPropertyDescriptors,Ee=Object.getOwnPropertyNames,j=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,ae=Object.prototype.propertyIsEnumerable;var ie=(s,e,t)=>e in s?N(s,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):s[e]=t,c=(s,e)=>{for(var t in e||(e={}))Y.call(e,t)&&ie(s,t,e[t]);if(j)for(var t of j(e))ae.call(e,t)&&ie(s,t,e[t]);return s},y=(s,e)=>Ae(s,Oe(e)),_e=s=>N(s,"__esModule",{value:!0});var v=(s,e)=>{var t={};for(var r in s)Y.call(s,r)&&e.indexOf(r)<0&&(t[r]=s[r]);if(s!=null&&j)for(var r of j(s))e.indexOf(r)<0&&ae.call(s,r)&&(t[r]=s[r]);return t};var Fe=(s,e)=>{for(var t in e)N(s,t,{get:e[t],enumerable:!0})},Pe=(s,e,t,r)=>{if(e&&typeof e=="object"||typeof e=="function")for(let o of Ee(e))!Y.call(s,o)&&(t||o!=="default")&&N(s,o,{get:()=>e[o],enumerable:!(r=we(e,o))||r.enumerable});return s};var Be=(s=>(e,t)=>s&&s.get(e)||(t=Pe(_e({}),e,1),s&&s.set(e,t),t))(typeof WeakMap!="undefined"?new WeakMap:0);var X=(s,e,t)=>{if(!e.has(s))throw TypeError("Cannot "+t)};var p=(s,e,t)=>(X(s,e,"read from private field"),t?t.call(s):e.get(s)),d=(s,e,t)=>{if(e.has(s))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(s):e.set(s,t)},L=(s,e,t,r)=>(X(s,e,"write to private field"),r?r.call(s,t):e.set(s,t),t),ge=(s,e,t,r)=>({set _(o){L(s,e,o,t)},get _(){return p(s,e,r)}}),k=(s,e,t)=>(X(s,e,"access private method"),t);var m=(s,e,t)=>new Promise((r,o)=>{var n=a=>{try{g(t.next(a))}catch(u){o(u)}},i=a=>{try{g(t.throw(a))}catch(u){o(u)}},g=a=>a.done?r(a.value):Promise.resolve(a.value).then(n,i);g((t=t.apply(s,e)).next())});var Qe={};Fe(Qe,{AddressAutofillCore:()=>q,Evented:()=>U,GeocodingCore:()=>te,LngLat:()=>l,LngLatBounds:()=>h,MapboxAutofill:()=>q,MapboxError:()=>I,MapboxGeocode:()=>te,MapboxValidate:()=>K,MatchCodeConfidence:()=>se,MatchCodeType:()=>re,SearchBoxCore:()=>H,SearchSession:()=>ne,SessionToken:()=>f,ValidationCore:()=>K,debounce:()=>W,featureToSuggestion:()=>Te,polyfillFetch:()=>de});var ce="https://api.mapbox.com/autofill/v1",Ue="suggest",Ce="retrieve",ue=`${ce}/${Ue}`,le=`${ce}/${Ce}`;var l=class{constructor(e,t){if(isNaN(e)||isNaN(t))throw new Error(`Invalid LngLat object: (${e}, ${t})`);if(this.lng=+e,this.lat=+t,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90");if(this.lng>180||this.lng<-180)throw new Error("Invalid LngLat longitude value: must be between -180 and 180")}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}static convert(e){if(e instanceof l)return new l(e.lng,e.lat);if(Array.isArray(e)&&e.length===2)return new l(Number(e[0]),Number(e[1]));if(!Array.isArray(e)&&typeof e=="object"&&e!==null&&("lng"in e||"lon"in e)&&"lat"in e)return new l(Number("lng"in e?e.lng:e.lon),Number(e.lat));throw new Error("`LngLatLike` argument must be specified as an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}};var h=class{constructor(e,t){this._sw=l.convert(e),this._ne=l.convert(t)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new l(this.getWest(),this.getNorth())}getSouthEast(){return new l(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toFlatArray(){return[this._sw.lng,this._sw.lat,this._ne.lng,this._ne.lat]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}static convert(e){if(!e)throw new Error("Invalid LngLatBounds convert value: falsy");if(e instanceof h)return new h(e.getSouthWest(),e.getNorthEast());if(Array.isArray(e)&&e.length===2)return new h(l.convert(e[0]),l.convert(e[1]));if(Array.isArray(e)&&e.length===4)return new h(l.convert([e[0],e[1]]),l.convert([e[2],e[3]]));throw new Error("`LngLatBoundsLike` argument must be specified as an array [<LngLatLike>, <LngLatLike>] or an array [<west>, <south>, <east>, <north>]")}};function pe(){let e=(Math.random().toString(16)+Date.now().toString(16)+Math.random().toString(16)).replace(/\./g,"");return[e.slice(0,8),e.slice(8,12),"4"+e.slice(12,15)+"-8"+e.slice(15,18),e.slice(18,30)].join("-")}var f=class{constructor(e){this.id=e!=null?e:pe()}toString(){return this.id}static convert(e){return new f(e instanceof f?e.id:e.toString())}};var Ge="Unknown error",I=class extends Error{constructor(e,t){super(String(e.message||e.error||Ge));this.name="MapboxError",this.statusCode=t}toString(){return`${this.name} (${this.statusCode}): ${this.message}`}};function b(s){return m(this,null,function*(){if(!s.ok){let e=yield s.json();throw new I(e,s.status)}})}var V=globalThis.fetch,me=globalThis.AbortController;function de({fetch:s,AbortController:e},t=!1){if(!s)throw new Error("Fetch implementation must include implementations of `fetch`.");V&&!t||(V=s,me=e)}function S(){if(!V)throw new Error("Fetch implementation not found. Please include a fetch polyfill in your application or use `polyfillFetch` from `@mapbox/search-js-core` to fix this issue.");return{fetch:V,AbortController:me}}function x(...s){let e=[];for(let t of s){if(!t)continue;let r=Object.entries(t);for(let[o,n]of r)n!=null&&e.push(`${o}=${encodeURIComponent(String(n))}`)}return e.join("&")}var F,D,$e,z=class{constructor(e={}){d(this,D);d(this,F,void 0);let o=e,{accessToken:t}=o,r=v(o,["accessToken"]);this.accessToken=t,this.defaults=c(c({},z.defaults),r)}get responseHeaders(){return p(this,F)}suggest(e,t){return m(this,null,function*(){if(!e)throw new Error("searchText is required");let{sessionToken:r,signal:o}=t,n=y(c(c({},this.defaults),t),{sessionToken:r}),i=new URL(`${ue}/${encodeURIComponent(e)}`);i.search=k(this,D,$e).call(this,n);let{fetch:g}=S(),a=yield g(i.toString(),{signal:o});L(this,F,a.headers),yield b(a);let u=yield a.json();return y(c({},u),{suggestions:u.suggestions.map(R=>y(c({},R),{original_search_text:e})),url:i.toString()})})}retrieve(e,t){return m(this,null,function*(){if(!e)throw new Error("suggestion is required");if(!this.canRetrieve(e))throw new Error("suggestion cannot be retrieved");let{sessionToken:r,signal:o}=t,n=f.convert(r),i=new URL(`${le}/${e.action.id}`);i.search=x({access_token:this.accessToken,session_token:n.id});let{fetch:g}=S(),a=yield g(i.toString(),{signal:o});yield b(a);let u=yield a.json();return u.url=i.toString(),u})}canRetrieve(e){let t=e.action;return typeof(t==null?void 0:t.id)=="string"}},q=z;F=new WeakMap,D=new WeakSet,$e=function(e){return x({types:"address",access_token:this.accessToken,streets:e.streets,language:e.language,country:e.country,limit:e.limit},e.sessionToken&&{session_token:f.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:l.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:h.convert(e.bbox).toFlatArray().join(",")})},q.defaults={language:"en",proximity:"ip",streets:!0};var M="https://api.mapbox.com/search/searchbox/v1",je="suggest",Ne="retrieve",Ie="category",Ve="reverse",fe=`${M}/${je}`,he=`${M}/${Ne}`,Se=`${M}/${Ie}`,Le=`${M}/${Ve}`;var P,ye,J=class{constructor(e={}){d(this,P);let o=e,{accessToken:t}=o,r=v(o,["accessToken"]);this.accessToken=t,this.defaults=c(c({},J.defaults),r)}suggest(e,t){return m(this,null,function*(){if(!e)throw new Error("searchText is required");let{sessionToken:r,signal:o}=t,n=y(c(c({},this.defaults),t),{q:e,sessionToken:r});if(n.eta_type&&(!n.origin||!n.navigation_profile))throw new Error("to provide eta estimate: eta, navigation_profile, and origin are required");if(n.origin&&!n.navigation_profile)throw new Error("to provide distance estimate: both navigation_profile and origin are required");let i=new URL(fe);i.search=k(this,P,ye).call(this,n);let{fetch:g}=S(),a=yield g(i.toString(),{signal:o});yield b(a);let u=yield a.json();return u.url=i.toString(),u})}retrieve(e,t){return m(this,null,function*(){if(!e)throw new Error("suggestion is required");let{sessionToken:r,signal:o,language:n}=t,i=f.convert(r),g=c(c({},this.defaults),n&&{language:n}),a=new URL(`${he}/${encodeURIComponent(e.mapbox_id)}`);a.search=x({access_token:this.accessToken,session_token:i.id},{language:g.language});let{fetch:u}=S(),R=yield u(a.toString(),{signal:o});yield b(R);let w=yield R.json();return w.url=a.toString(),w})}category(r){return m(this,arguments,function*(e,t={}){if(!e)throw new Error("category is required");let o=c(c({},this.defaults),t),n=new URL(`${Se}/${encodeURIComponent(e)}`);n.search=k(this,P,ye).call(this,o);let{fetch:i}=S(),g=yield i(n.toString(),{signal:o.signal});yield b(g);let a=yield g.json();return a.url=n.toString(),a})}reverse(r){return m(this,arguments,function*(e,t={}){if(!e)throw new Error("lngLat is required");let[o,n]=typeof e=="string"?e.split(",").map(w=>parseFloat(w)):l.convert(e).toArray();if(isNaN(o)||isNaN(n))throw new Error("lngLat is required");let i=c(c({},this.defaults),t),g=new URL(Le);g.search=x({access_token:this.accessToken,language:i.language,limit:i.limit,longitude:o,latitude:n},i.types&&{types:typeof i.types=="string"?i.types:[...i.types].join(",")});let{fetch:a}=S(),u=yield a(g.toString(),{signal:i.signal});yield b(u);let R=yield u.json();return R.url=g.toString(),R})}},H=J;P=new WeakSet,ye=function(e){return x({q:e.q,access_token:this.accessToken,language:e.language,limit:e.limit,navigation_profile:e.navigation_profile,route:e.route,route_geometry:e.route_geometry,sar_type:e.sar_type,time_deviation:e.time_deviation,eta_type:e.eta_type,country:e.country,poi_category:e.poi_category,rich_metadata_provider:e.rich_metadata_provider,poi_category_exclusions:e.poi_category_exclusions},e.sessionToken&&{session_token:f.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:l.convert(e.proximity).toArray().join(",")},e.origin&&{origin:typeof e.origin=="string"?e.origin:l.convert(e.origin).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:h.convert(e.bbox).toFlatArray().join(",")},e.types&&{types:typeof e.types=="string"?e.types:[...e.types].join(",")})},H.defaults={language:"en"};var qe="https://api.mapbox.com/autofill/v1",De="retrieve",be=`${qe}/${De}`;var Q,Me,Z=class{constructor(e={}){d(this,Q);let o=e,{accessToken:t}=o,r=v(o,["accessToken"]);this.accessToken=t,this.defaults=c(c({},Z.defaults),r)}validate(e,t){return m(this,null,function*(){if(!e)throw new Error("searchText is required");let{sessionToken:r,signal:o}=t,n=y(c(c({},this.defaults),t),{sessionToken:r}),i=new URL(`${be}/${encodeURIComponent(e)}`);i.search=k(this,Q,Me).call(this,n);let{fetch:g}=S(),a=yield g(i.toString(),{signal:o});yield b(a);let u=yield a.json();return u.url=i.toString(),u.features.length>0&&(u.features=[u.features[0]]),u})}},K=Z;Q=new WeakSet,Me=function(e){return x({access_token:this.accessToken,language:e.language,country:e.country},e.sessionToken&&{session_token:f.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:l.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:h.convert(e.bbox).toFlatArray().join(",")})},K.defaults={language:"en",proximity:"ip"};var ee="https://api.mapbox.com/search/geocode/v6",xe=`${ee}/forward`,Re=`${ee}/reverse`,Vt=`${ee}/batch`;var He=/^[ ]*(-?\d{1,3}(\.\d{0,256})?)[, ]+(-?\d{1,3}(\.\d{0,256})?)[ ]*$/,Ke=/[\s,]+/,O,B,ke,te=class{constructor(e={}){d(this,B);d(this,O,void 0);let o=e,{accessToken:t}=o,r=v(o,["accessToken"]);this.accessToken=t,this.defaults=c({},r)}get responseHeaders(){return p(this,O)}forward(e,t){return m(this,null,function*(){if(!e)throw new Error("searchText is required");let r;t&&({signal:r}=t);let o=y(c(c({},this.defaults),t),{q:e}),n=new URL(`${xe}`);n.search=k(this,B,ke).call(this,o);let{fetch:i}=S(),g=r?{signal:r}:{},a=yield i(n.toString(),g);L(this,O,a.headers),yield b(a);let u=yield a.json();return u.url=n.toString(),u})}reverse(e,t){return m(this,null,function*(){if(!e)throw new Error("lngLat is required");let r;t&&({signal:r}=t);let o;if(typeof e=="string"){let[w,ve]=e.split(",");o=new l(Number(w),Number(ve))}else o=l.convert(e);let n=y(c(c({},this.defaults),t),{longitude:o.lng,latitude:o.lat}),i=new URL(`${Re}`);i.search=k(this,B,ke).call(this,n,!0);let{fetch:g}=S(),a=r?{signal:r}:{},u=yield g(i.toString(),a);L(this,O,u.headers),yield b(u);let R=yield u.json();return R.url=i.toString(),R})}suggest(e,t){return m(this,null,function*(){if(He.test(e)){let o=e.trim().split(Ke).map(n=>n.trim()).join(",");return this.reverse(o,t)}else return this.forward(e,t)})}retrieve(e){return m(this,null,function*(){return e})}};O=new WeakMap,B=new WeakSet,ke=function(e,t=!1){return t&&["proximity","autocomplete","bbox"].forEach(r=>{r in e&&delete e[r]}),x({q:e.q,longitude:e.longitude,latitude:e.latitude,access_token:this.accessToken,permanent:e.permanent,language:e.language,country:e.country,limit:e.limit,autocomplete:e.autocomplete,worldview:e.worldview},e.sessionToken&&{session_token:f.convert(e.sessionToken).id},e.proximity&&{proximity:typeof e.proximity=="string"?e.proximity:l.convert(e.proximity).toArray().join(",")},e.bbox&&{bbox:typeof e.bbox=="string"?e.bbox:h.convert(e.bbox).toFlatArray().join(",")},e.types&&{types:typeof e.types=="string"?e.types:[...e.types].join(",")})};var re=(n=>(n.matched="matched",n.unmatched="unmatched",n.plausible="plausible",n.not_applicable="not_applicable",n.inferred="inferred",n))(re||{}),se=(o=>(o.exact="exact",o.high="high",o.medium="medium",o.low="low",o))(se||{});var E,U=class{constructor(){d(this,E,{})}addEventListener(e,t){let r=p(this,E);r[e]||(r[e]=[]),r[e].push(t)}removeEventListener(e,t){let r=p(this,E);if(!r[e])return;let o=r[e],n=o.indexOf(t);n!==-1&&o.splice(n,1)}fire(e,t){let r=p(this,E);if(!r[e])return;let o=r[e];for(let n of o)n(t)}};E=new WeakMap;function W(s,e,t){let r=null;return(...o)=>{r!==null&&clearTimeout(r);let n=t&&t();r=setTimeout(()=>{r=null,!(n==null?void 0:n.aborted)&&s(...o)},e)}}function oe(){let{AbortController:s}=S();return new s}var _,C,G,A,T,$,ne=class extends U{constructor(e,t=0){super();d(this,_,new f);d(this,C,0);d(this,G,!1);d(this,A,void 0);d(this,T,oe());d(this,$,void 0);L(this,$,W((n,...i)=>m(this,[n,...i],function*(r,o={}){if(p(this,T).abort(),L(this,T,oe()),!r){L(this,A,null),this.fire("suggest",p(this,A));return}try{let g=yield this.search.suggest(r,y(c({sessionToken:this.sessionToken},o),{signal:p(this,T).signal}));L(this,A,g),this.fire("suggest",g)}catch(g){if(g.name==="AbortError")return;this.fire("suggesterror",g)}}),t,()=>p(this,T).signal)),Object.defineProperties(this,{search:{value:e,writable:!1},debounce:{value:t,writable:!1}})}get sessionToken(){return p(this,G)?p(this,_).id:`${p(this,_).id}.${p(this,C)}`}set sessionToken(e){L(this,G,!0),L(this,_,new f(e))}get suggestions(){return p(this,A)}suggest(e,t){return p(this,$).call(this,e,t),new Promise((r,o)=>{let n,i;n=g=>{this.removeEventListener("suggest",n),this.removeEventListener("suggesterror",i),r(g)},i=g=>{this.removeEventListener("suggest",n),this.removeEventListener("suggesterror",i),o(g)},this.addEventListener("suggest",n),this.addEventListener("suggesterror",i)})}clear(){this.suggest("")}retrieve(e,t){return m(this,null,function*(){let r=yield this.search.retrieve(e,c({sessionToken:this.sessionToken},t));return this.fire("retrieve",r),r})}canRetrieve(e){return this.search.canRetrieve?this.search.canRetrieve(e):!0}canSuggest(e){return this.search.canSuggest?this.search.canSuggest(e):!0}abort(){p(this,T).abort(),L(this,T,oe())}incrementSession(){ge(this,C)._++}};_=new WeakMap,C=new WeakMap,G=new WeakMap,A=new WeakMap,T=new WeakMap,$=new WeakMap;function Te(s){let{properties:e}=s;return c({},e)}return Be(Qe);})();
//# sourceMappingURL=mapboxsearchcore.js.map
